(self.webpackChunkssta=self.webpackChunkssta||[]).push([[873,640],{873:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Oe});var n=a(640);function r(e){return e`# Marine heatwave charts and brush/player

used to embed as a module in https://cioospacific.ca/applied-data/marine-heat-monitor/

curl -o bs.tgz "https://api.observablehq.com/d/0b936d79280ee3bd.tgz?v=3"

tar -C src/buoyviz -xvzf bs.tgz

This notebook includes
- loading the buoy data via api
- data brush chart (loads from github)
- scrubber for playing the animation in the website
- charts for the buoys


`}function i(e,t,a){return e`# ${t(new Date(a))}`}function o(e){return e`date to stop playing. Ideally this should be a only a couple days in the past since data is usually updated each day`}function l(){return new Date("2022-06-01")}function s(e,t,a){return e`
<style>

  /* match the scrubber's width to our race chart */
   // input[type="range"][name="i"] {
   //   width: ${t-90}px !important;
   // }

.${a}{
  font-size: 16px;  
}


button, input, textarea {
    accent-color: #007490;
}

#butt input, textarea {
    accent-color: green;
}
.brushFilter {
background-color: #606060;
color: "#e0f5ee"
}

.currentDot{
background-color: none;
color: "#e0f5ee"
}

.axisWhite line{
  stroke: #e0f5ee;
}

.axisWhite path{
  stroke: #e0f5ee;
}

// .selection{
// fill: #d9d9d9;
// fill-opacity: .6;
// stroke: none;
// }

.radio {

  color: deeppink;
}
  .button {
color:lightgrey;
  border: 0;
  background: transparent;
  box-sizing: border-box;
  width: 100;
  height: 74px;
  border-color: transparent transparent transparent lightgrey;
  transition: 100ms all ease;
  cursor: pointer;
  border-style: solid;
  border-width: 37px 0 37px 60px;
transform: scale(.7);
}
.paused {
  border-style: double;
  border-width: 0px 0 0px 60px;
}
.button:hover {
  border-color: transparent transparent transparent #8f8f8f;
}
input{
 accent-color:black
}
.fa-xs {
    font-size: 5.75em;
}

</style>
`}function u(e){return e}function d(e){return e`play`}function c(e){return e}function f(e,t,a){return e(t,{width:0,delay:100,initial:a,autoplay:!1,loop:!1,format:e=>""})}function m(e){return e`anomaly or category button`}function b(e,t){return e.radio(["Anomaly","Heatwaves"],{value:"Anomaly",format:e=>t`<span style="color: white">${e}`})}function h(){return 0}function p(e,t,a,n,r,i,o,l,s,u,d,c,f,m,b,h){if("Heatwaves"===e){const e=t,m=a.create("svg").attr("viewBox",[0,0,n,e]).style("display","block"),b=a.scaleLinear().domain([0,1]).range([e-r.bottom,r.top+5]),h=(e,t,i)=>e.attr("transform",`translate(0,${i-r.bottom})`).call(a.axisBottom(t).ticks(n/80).tickSizeOuter(0)).style("stroke","#e0f5ee");m.append("g").call(h,i,e).attr("class","axisWhite");const p=o(l);return m.append("g").selectAll("g").data(p).join("g").style("fill",((e,t)=>s.get(e.key))).selectAll("rect").data((e=>e)).join("rect").attr("x",(e=>u(new Date(e.data.date).toISOString().substring(0,10)))).attr("y",(e=>b(e[1]))).attr("height",(e=>b(e[0])-b(e[1]))).attr("width",u.bandwidth()),m.append("line").datum([{date:d,value:1}]).attr("x1",(e=>c(d))).attr("x2",(e=>c(d))).attr("y2",b(1)).attr("y1",b(0)).attr("fill","none").attr("stroke","deeppink").attr("stoke-width",1.5).attr("stroke-linejoin","round"),m.selectAll("circle").data([{date:d,value:1}]).join("circle").attr("cx",(e=>c(e.date))).attr("cy",(e=>b(.98))).attr("r",7).attr("fill",(e=>"deeppink")).attr("stroke",(e=>"deeppink")).call(f),m.node()}{const e=t,i=a.create("svg").attr("viewBox",[0,0,n,e]).style("display","block"),o=a.scaleLinear().domain([0,1]).range([e-r.bottom,r.top+5]),l=(e,t,i)=>e.attr("transform",`translate(0,${i-r.bottom})`).call(a.axisBottom(t).ticks(n/80).tickSizeOuter(0)).style("stroke","#e0f5ee");i.append("g").call(l,c,e).attr("class","axisWhite");const s=a.scaleBand().range([r.left,n-r.right],.01).padding(.01).domain(m);return i.selectAll("rect").data(b).enter().append("rect").attr("x",(e=>s(e.date.toISOString().substring(0,10)))).attr("y",(e=>o(1))).attr("width",(e=>s.bandwidth())).attr("height",(e=>o(0)-o(1))).attr("fill",(e=>h(e.value))),i.append("line").datum([{date:d,value:1}]).attr("x1",(e=>c(d))).attr("x2",(e=>c(d))).attr("y2",o(1)).attr("y1",o(0)).attr("fill","none").attr("stroke","deeppink").attr("stoke-width",1.5).attr("stroke-linejoin","round"),i.selectAll("circle").data([{date:d,value:1}]).join("circle").attr("cx",(e=>c(e.date))).attr("cy",(e=>o(.98))).attr("r",7).attr("fill",(e=>"deeppink")).attr("stroke",(e=>"deeppink")).call(f),i.node()}}function v(e,t,a,n,r,i,o){return e.drag().on("start",(function(t,a){e.select(this).raise().attr("stroke","black")})).on("drag",(function(l,s){let u=l.x>t(+a[0]),d=l.x<t(+n);if(u&&d){e.select(this).attr("cx",s.x=l.x);const a=e.bisect(r,+t.invert(l.x));i.value=a,o.update(a)}})).on("end",(function(t,a){e.select(this).attr("stroke",null)}))}function g(e){return e}function y(){return null}function w(e,t,a,n,r,i,o,l,s,u,d,c,f,m,b){if("Heatwaves"===e){const e=t.create("svg").attr("viewBox",[0,0,a,n]).style("display","block"),f=t.scaleTime().domain(r).range([i.left,a-i.right]),m=t.brushX().extent([[i.left,.5],[a-i.right,n-i.bottom+.5]]).on("brush",y).on("end",w),b=[f(t.utcYear.offset(f.domain()[1],-1)),f.range()[1]];let h,p;e.append("g").call(o,f,n).attr("class","axisWhite");const v=l(s);e.append("g").selectAll("g").data(v).join("g").style("fill",((e,t)=>u.get(e.key))).selectAll("rect").data((e=>e)).join("rect").attr("x",(e=>d(new Date(e.data.date).toISOString().substring(0,10)))).attr("y",(e=>c(e[1]))).attr("height",(e=>c(e[0])-c(e[1]))).attr("width",d.bandwidth());const g=e.append("g").call(m);function y({selection:n}){if(n){var r=n||f.range();if(e.property("value",n.map(f.invert,f).map(t.utcMonth.ceil)),e.dispatch("input"),(r[1]-r[0])/a*120>30)return void g.call(m.move,[h,p]);h=r[0],p=r[1]}}function w({selection:e}){e||g.call(m.move,[b])}return g.call(m.move,b),e.node()}{const e=t.create("svg").attr("viewBox",[0,0,a,n]).style("display","block"),l=t.scaleTime().domain(r).range([i.left,a-i.right]),s=t.brushX().extent([[i.left,.5],[a-i.right,n-i.bottom+.5]]).on("brush",g).on("end",y),u=[l(t.utcYear.offset(l.domain()[1],-1)),l.range()[1]];let h,p;e.append("g").call(o,l,n).attr("class","axisWhite"),e.selectAll("rect").data(f).enter().append("rect").attr("x",(e=>d(e.date.toISOString().substring(0,10)))).attr("y",(e=>c(1))).attr("width",(e=>d.bandwidth())).attr("height",(e=>c(0)-c(1))).attr("fill",(e=>m(e.value)));const v=e.append("g").call(s);function g({selection:n}){if(n){var r=n||l.range();if(e.property("value",n.map(l.invert,l).map(t.utcMonth.ceil)),e.dispatch("input"),(r[1]-r[0])/a*120>30||(r[1]-r[0])/a*120<2)return void v.call(s.move,[h,p]);h=r[0],p=r[1]}}function y({selection:e}){e||(b.value=u,v.call(s.move,[h,p]))}return v.call(s.move,u),e.node()}}function x(e,t){return e` ${"Anomaly"===t?"Sea surface temperature anomaly":" "}`}function k(e,t){return"Anomaly"===e?t.legend({marginLeft:10,marginRight:10,style:{backgroundColor:"#000000",color:"#e0f5ee",fontSize:"16px",fontWeight:"normal"},color:{type:"diverging",domain:[-4,4],pivot:0,reverse:!0,legend:!0,label:""}}):t.legend({color:{type:"categorical",domain:["No heatwave","Moderate","Strong","Severe","Extreme"],range:["lightblue","#FEDB67","#f26722","#cd3728","#7E1416"]},style:{backgroundColor:"#000000",color:"#e0f5ee",fontSize:"16px",fontWeight:"normal"}})}function S(e,t,a,n,r,i,o,l,s,u,d,c,f,m,b){const h=0===e.length?"":"Temperature anomaly (°C)",p=t.plot({x:{domain:[a[0],a[1]]},y:{label:"↑ SST (°C)",domain:[0,n]},style:{backgroundColor:"#000000",color:"#e0f5ee",fontSize:10},height:500,marginTop:20,className:"hwclass",marks:[t.dot(e,{x:"date",y:"sst",stroke:"category",fill:"category"}),t.ruleX([r],{stroke:"white",y1:0,y2:i.max(e,(e=>e.sst))}),t.text([{x:o,y:l,text:s}],{x:"x",y:"y",text:"text",fontSize:16})],color:{domain:["none","Moderate","Strong","Severe","Extreme"],range:[u.get("none"),u.get("Moderate"),u.get("Strong"),u.get("Severe"),u.get("Extreme")]},width:500,height:300}),v=t.plot({x:{domain:[a[0],a[1]]},y:{label:"↑ SST (°C)",domain:[0,n]},style:{backgroundColor:"#000000",color:"#e0f5ee",fontSize:10},height:500,marginTop:20,className:"hwclass",marks:[t.dot(e,{x:"date",y:"sst",stroke:"ssta",fill:"ssta"}),t.ruleX([r],{stroke:"white",y1:0,y2:i.max(e,(e=>e.sst))}),t.text([{x:o,y:l,text:s}],{x:"x",y:"y",text:"text",fontSize:16}),t.text([{x:d,y:l,text:h}],{x:"x",y:"y",text:"text",fontSize:10}),t.text([{x:d,y:l-1,text:c}],{x:"x",y:"y",text:"text",fontSize:10})],color:{type:"diverging",domain:[-4,4],pivot:0,reverse:!0},width:500,height:300});return null!==f?"Anomaly"===m?v:p:b``}function D(e,t){return e.indexOf(t)}function C(e){return e.timeDay.offset(e.utcDay(),-2)}function M(e,t){return e.timeDay.offset(t,-365)}async function A(e,t){return await e.delay(1e3,""),t}async function T(e,t){return await e.delay(1e3,""),t}function E(e){return e`## bar charts`}function H(){return 60}function W(){return{top:4,right:20,bottom:30,left:10}}function N(e,t,a,n){return e.scaleBand().range([t.left,a-t.right],.01).padding(.1).domain(n)}function _(e,t,a,n){return e.scaleBand().range([t.left,a-t.right],.01).padding(.01).domain(n)}function F(e,t,a){return(n,r,i)=>n.attr("transform",`translate(0,${i-e.bottom})`).call(t.axisBottom(r).ticks(a/80).tickSizeOuter(0)).style("stroke","#e0f5ee")}function I(e,t,a){return e.scaleLinear().domain([0,1]).range([t-a.bottom,a.top])}function O(e,t){return e.filter((e=>e.date>=t[0]&&new Date(e.date)<new Date(t[1])))}function j(e,t){return e.timeMonth.range(new Date(t[0]),t[1]).map((e=>e.toISOString().substring(0,10)))}function z(e,t){return e.timeMonth.range(new Date(t[0]),new Date(t[1])).map((e=>e.toISOString().substring(0,10)))}function B(e,t,a,n){return e.scaleTime().domain(t).range([a.left,n-a.right])}function L(e,t,a,n){return e.scaleTime().domain(t).range([a.left,n-a.right])}function V(e,t){return e.stack().keys(t)}function $(e,t){return e.filter((e=>e.date>=t[0]&&new Date(e.date)<new Date(t[1])))}function P(e){return e.scaleDiverging(e.interpolateRdBu).domain([4,0,-4])}function G(e){return(t,a,n,r)=>t.selectAll(".handle--custom").data([{type:"w"},{type:"e"}]).join((t=>t.append("path").attr("class","handle--custom").attr("fill","#afafaf").attr("fill-opacity",.8).attr("stroke","#000").attr("stroke-width",1).attr("cursor","ew-resize").attr("d",e))).attr("display",null===a?"none":null).attr("transform",null===a?null:(e,t)=>`translate(${a[t]},${(r+n.top-n.bottom)/2})`)}function q(e){return e.arc().innerRadius(0).outerRadius(10).startAngle(0).endAngle(((e,t)=>t?Math.PI:-Math.PI))}function R(e){const t=[];return Object.keys(e).forEach((a=>{t.push({date:new Date(a.slice(0,4)+"-"+a.slice(-2)),value:e[a][0]})})),t}function U(e){return e.text().classList[0]}function X(e,t){return e.filter((e=>e>=t[0]&&e<=t[1]))}function Y(e,t){return e.timeDay.range(new Date(t[0]),new Date(t[1])).map((e=>+e))}function J(e){return[...e]}function K(){return[new Date("2013-01-01"),new Date]}function Q(){return 11}function Z(e,t){return e.find((e=>e.long_name===t)).pk}function ee(e){return e}function te(e,t){return e.select([null].concat(t.map((e=>e.long_name))),{label:"site",value:"North Hecate Strait"})}function ae(e,t){let a;return a=0!==e.length?e.find((e=>new Date(e.date).toISOString().substring(0,10)===new Date(t).toISOString().substring(0,10))).ssta.toFixed(2):"",a}function ne(e,t){return void 0===e[Math.floor(e.length/1.2)]?18:1.1*t.max(e,(e=>e.sst))}function re(e,t){return void 0===e[Math.floor(e.length/1.2)]?18:1.1*t.max(e,(e=>e.sst))}function ie(e,t,a){return void 0===e[Math.floor(e.length/1.2)]?t.timeDay.offset(a[0],30):e[Math.floor(.2*e.length)].date}function oe(e,t,a){return void 0===e[Math.floor(e.length/2)]?t.timeDay.offset(a[0],30):e[Math.floor(.8*e.length)].date}function le(e,t){return e.find((e=>e.pk===t)).long_name}function se(e){return e[e.length-1]}function ue(e,t){return e.filter((e=>e.station===t))}function de(){return new Map([["avg","#5b6187"],["thresh","#FEDB67"],["below","#89119c"],["above","pink"],["none","lightblue"],["Moderate","#FEDB67"],["Strong","#f26722"],["Severe","#cd3728"],["Extreme","#7E1416"],["seas","pink"]])}function ce(){return[{short_name:"C46004",lat:50.94,lon:-135.87,long_name:"Middle Nomad",pk:1},{short_name:"C46036",lat:48.3,lon:-133.86,long_name:"South Nomad",pk:2},{short_name:"C46131",lat:49.91,lon:-124.99,long_name:"Sentry Shoal",pk:3},{short_name:"C46132",lat:49.74,lon:-127.93,long_name:"South Brooks",pk:4},{short_name:"C46145",lat:54.38,lon:-132.42,long_name:"Central Dixon Entran",pk:6},{short_name:"C46146",lat:49.34,lon:-123.73,long_name:"Halibut Bank",pk:7},{short_name:"C46147",lat:51.83,lon:-131.23,long_name:"South Moresby",pk:8},{short_name:"C46183",lat:53.57,lon:-131.14,long_name:"North Hecate Strait",pk:11},{short_name:"C46184",lat:53.92,lon:-138.85,long_name:"North Nomad",pk:12},{short_name:"C46185",lat:52.42,lon:-129.79,long_name:"South Hecate Strait",pk:13},{short_name:"C46204",lat:51.38,lon:-128.77,long_name:"West Sea Otter",pk:14},{short_name:"C46205",lat:54.3,lon:-133.4,long_name:"West Dixon Entrance",pk:15},{short_name:"C46206",lat:48.83,lon:-126,long_name:"La Perouse Bank",pk:16},{short_name:"C46207",lat:50.88,lon:-129.91,long_name:"East Dellwood",pk:17},{short_name:"C46208",lat:52.51,lon:-132.69,long_name:"West Moresby",pk:18}]}function fe(e,t){return e.filter((e=>new Date(t).toISOString().substring(0,10)===new Date(e.result_time).toISOString().substring(0,10)))}function me(e){const t=Object.assign(e[0]),a=new Date(t);return new Date(a.setDate(a.getDate()-1)).toISOString().substring(0,10)}function be(e,t){return fetch("https://t6r95rekqe.execute-api.us-east-1.amazonaws.com/dev/getDailySSTStats?startDate="+e+"&endDate="+t[1].toISOString().substring(0,10)).then((e=>e.json())).then((e=>(e.forEach((e=>{e.ssta=e.sst-e.seas,e.diff=e.thresh,e.diffStrong=e.thresh,e.diffExtreme=e.thresh,e.diffSevere=e.thresh,"Strong"===e.category&&(e.diffStrong=Math.max(e.thresh,e.sst)),"Extreme"===e.category&&(e.diffExtreme=Math.max(e.thresh,e.sst)),"Severe"===e.category&&(e.diffSevere=Math.max(e.thresh,e.sst)),"Moderate"===e.category&&(e.diff=Math.max(e.thresh,e.sst)),null===e.category&&(e.category="none"),e.date=new Date(e.result_time)})),e)))}function he(){return 500}function pe(e){return e.scaleOrdinal().domain(["none","Moderate","Strong","Severe","Extreme"]).range(["#31a354","#FEDB67","#f26722","#7E1416","#cd3728"])}function ve(e){return e.scaleOrdinal().domain(["none","Moderate","Strong","Severe","Extreme"])}function ge(e){return e.format(",d")}function ye(e){return e.timeFormat("%Y-%m-%d")}function we(e){return e("d3@6")}function xe(e){return new Date(e).toISOString().substring(0,10)}function ke(){return[{date:"2013-10-01",value:1},{date:"2013-11-01",value:1},{date:"2013-12-01",value:1},{date:"2014-01-01",value:1},{date:"2014-02-01",value:1},{date:"2014-03-01",value:1},{date:"2014-04-01",value:1},{date:"2014-05-01",value:1},{date:"2014-06-01",value:1},{date:"2014-07-01",value:1},{date:"2014-08-01",value:1},{date:"2014-09-01",value:1},{date:"2014-10-01",value:1},{date:"2014-11-01",value:1},{date:"2014-12-01",value:1},{date:"2015-01-01",value:1},{date:"2015-02-01",value:1},{date:"2015-03-01",value:1},{date:"2015-04-01",value:1},{date:"2015-05-01",value:1},{date:"2015-06-01",value:1},{date:"2015-07-01",value:1},{date:"2015-08-01",value:1},{date:"2015-09-01",value:1},{date:"2015-10-01",value:1},{date:"2015-11-01",value:1},{date:"2015-12-01",value:1},{date:"2016-01-01",value:1},{date:"2016-02-01",value:1},{date:"2016-03-01",value:1},{date:"2016-04-01",value:1},{date:"2016-05-01",value:1},{date:"2016-06-01",value:1},{date:"2016-07-01",value:1},{date:"2016-08-01",value:1},{date:"2016-09-01",value:1},{date:"2016-10-01",value:1},{date:"2016-11-01",value:1},{date:"2019-08-01",value:1},{date:"2019-09-01",value:1},{date:"2019-10-01",value:1},{date:"2019-11-01",value:1}]}function Se(e,t){return e.timeMonth.range(new Date(t[0]),new Date(t[1])).map((e=>e.toISOString().substring(0,10)))}function De(e){return[...new Set(e.map((e=>e.date.slice(0,7))))]}function Ce(e){return e.filter((e=>"2013-01"===e.date))}function Me(e,t,a,n){const r=[];return e.forEach((e=>{let i=0;for(let o=0;o<t.length;o++){let l=a.sum(n.filter((t=>+new Date(t.month)==+new Date(e))),(e=>e[t[o]]));r.push({date:e,[t[o]]:l}),i+=l}})),r}function Ae(e,t){const a=[];return e.forEach((e=>{let n=0;e[1].forEach((e=>{n+=Object.values(e)[1]})),a.push({date:new Date(e[0]),[t[0]]:e[1][0][t[0]]/n,[t[1]]:e[1][1][t[1]]/n,[t[2]]:e[1][2][t[2]]/n,[t[3]]:e[1][3][t[3]]/n,[t[4]]:e[1][4][t[4]]/n,sum:n})})),a}function Te(){return["none","Moderate","Strong","Extreme","Severe"]}function Ee(e,t){return e.groups(t,(e=>+new Date(e.date)))}async function He(e){const t=await e("monthlyMHW@4.json").json(),a=[];return Object.keys(t).forEach((e=>{for(let n=0;n<1;n++)t[e].reduce(((e,t)=>e+t),0),a.push({date:e.replace(/(\d{4})(\d{2})(\d{2})/g,"$1-$2-$3"),month:e.replace(/(\d{4})(\d{2})(\d{2})/g,"$1-$2-$3").slice(0,7),none:t[e][0],Moderate:t[e][1],Strong:t[e][2],Extreme:t[e][3],Severe:t[e][4]})})),a}function We(e){return e("monthlyMHW@4.json").json()}function Ne(e){return e[202203]}function _e(e){return e[202204]}function Fe(){return fetch("https://raw.githubusercontent.com/HakaiInstitute/ssta_images/gh-pages/src/monthly.json",{Method:"GET"}).then((e=>e.json()))}function Ie(e){return e("monthly@7.json").json()}function Oe(e,t){const Oe=e.module();function je(){return this.url}const ze=new Map([["monthly@7.json",{url:new URL(a(383),a.b),mimeType:"application/json",toString:je}],["monthlyMHW@4.json",{url:new URL(a(201),a.b),mimeType:"application/json",toString:je}]]);Oe.builtin("FileAttachment",e.fileAttachments((e=>ze.get(e)))),Oe.variable(t()).define(["md"],r),Oe.variable(t("curDate")).define("curDate",["md","timeFormat","time1"],i),Oe.variable(t()).define(["md"],o),Oe.variable(t("endPlayDate")).define("endPlayDate",l),Oe.variable(t("style")).define("style",["html","width","ns"],s),Oe.variable(t()).define(["brushedData"],u),Oe.variable(t()).define(["md"],d),Oe.variable(t()).define(["time1"],c),Oe.variable(t("viewof time1")).define("viewof time1",["Scrubber","datesToPlot","newNum"],f),Oe.variable(t("time1")).define("time1",["Generators","viewof time1"],((e,t)=>e.input(t))),Oe.variable(t()).define(["md"],m),Oe.variable(t("viewof colorView")).define("viewof colorView",["Inputs","html"],b),Oe.variable(t("colorView")).define("colorView",["Generators","viewof colorView"],((e,t)=>e.input(t))),Oe.define("initial newNum",h),Oe.variable(t("mutable newNum")).define("mutable newNum",["Mutable","initial newNum"],((e,t)=>new e(t))),Oe.variable(t("newNum")).define("newNum",["mutable newNum"],(e=>e.generator)),Oe.variable(t("chart")).define("chart",["colorView","focusHeight","d3","width","margin","xMHW","stack","brushedDataMHW","colors","x1MHW","time1","x","drag","brusedAllDates","brushedData","sstaColors"],p),Oe.variable(t("drag")).define("drag",["d3","x","focus","endPlayDate","datesToPlot","mutable newNum","viewof time1"],v),Oe.variable(t()).define(["focus"],g),Oe.define("initial debug1",y),Oe.variable(t("mutable debug1")).define("mutable debug1",["Mutable","initial debug1"],((e,t)=>new e(t))),Oe.variable(t("debug1")).define("debug1",["mutable debug1"],(e=>e.generator)),Oe.variable(t("viewof focus")).define("viewof focus",["colorView","d3","width","focusHeight","dateExtent","margin","xAxis","stack","monthlyGrouped","colors","x1","y","data","sstaColors","mutable debug1"],w),Oe.variable(t("focus")).define("focus",["Generators","viewof focus"],((e,t)=>e.input(t))),Oe.variable(t("legTitle")).define("legTitle",["md","colorView"],x),Oe.variable(t("leg")).define("leg",["colorView","Plot"],k),Oe.variable(t("viewof lineChart")).define("viewof lineChart",["clickedSite","Plot","limitsDelayed","yMaxDomainToUse","time1","d3","dateForLabel","yValueForLabel","buoyClicked","colors","dateForLabelVal","currentValue","siteClicked","colorView","md"],S),Oe.variable(t("lineChart")).define("lineChart",["Generators","viewof lineChart"],((e,t)=>e.input(t))),Oe.variable(t("ind")).define("ind",["dates","time1"],D),Oe.variable(t("today")).define("today",["d3"],C),Oe.variable(t("start")).define("start",["d3","today"],M),Oe.variable(t("limitsDelayed")).define("limitsDelayed",["Promises","focus"],A),Oe.variable(t("limitsDelayedMHW")).define("limitsDelayedMHW",["Promises","focus"],T),Oe.variable(t()).define(["md"],E),Oe.variable(t("focusHeight")).define("focusHeight",H),Oe.variable(t("margin")).define("margin",W),Oe.variable(t("x1")).define("x1",["d3","margin","width","alldates"],N),Oe.variable(t("x1MHW")).define("x1MHW",["d3","margin","width","brusedAllDatesMHW"],_),Oe.variable(t("xAxis")).define("xAxis",["margin","d3","width"],F),Oe.variable(t("y")).define("y",["d3","focusHeight","margin"],I),Oe.variable(t("brushedDataMHW")).define("brushedDataMHW",["monthlyGrouped","focus"],O),Oe.variable(t("brusedAllDates")).define("brusedAllDates",["d3","focus"],j),Oe.variable(t("brusedAllDatesMHW")).define("brusedAllDatesMHW",["d3","focus"],z),Oe.variable(t("x")).define("x",["d3","focus","margin","width"],B),Oe.variable(t("xMHW")).define("xMHW",["d3","focus","margin","width"],L),Oe.variable(t("stack")).define("stack",["d3","cats"],V),Oe.variable(t("brushedData")).define("brushedData",["data","focus"],$),Oe.variable(t("sstaColors")).define("sstaColors",["d3"],P),Oe.variable(t("brushHandle")).define("brushHandle",["arc"],G),Oe.variable(t("arc")).define("arc",["d3"],q),Oe.variable(t("data")).define("data",["dataSsta"],R),Oe.variable(t("ns")).define("ns",["Inputs"],U),Oe.variable(t("datesToPlot")).define("datesToPlot",["datesCopy","limitsDelayed"],X),Oe.variable(t("dates")).define("dates",["d3","dateExtent"],Y),Oe.variable(t("datesCopy")).define("datesCopy",["dates"],J),Oe.variable(t("dateExtent")).define("dateExtent",K),Oe.define("initial siteClicked",Q),Oe.variable(t("mutable siteClicked")).define("mutable siteClicked",["Mutable","initial siteClicked"],((e,t)=>new e(t))),Oe.variable(t("siteClicked")).define("siteClicked",["mutable siteClicked"],(e=>e.generator)),Oe.variable(t()).define(["buoys","siteClickeds"],Z),Oe.variable(t()).define(["siteClickeds"],ee),Oe.variable(t("viewof siteClickeds")).define("viewof siteClickeds",["Inputs","buoys"],te),Oe.variable(t("siteClickeds")).define("siteClickeds",["Generators","viewof siteClickeds"],((e,t)=>e.input(t))),Oe.variable(t("currentValue")).define("currentValue",["clickedSite","time1"],ae),Oe.variable(t("yMaxDomainToUse")).define("yMaxDomainToUse",["clickedSite","d3"],ne),Oe.variable(t("yValueForLabel")).define("yValueForLabel",["clickedSite","d3"],re),Oe.variable(t("dateForLabel")).define("dateForLabel",["clickedSite","d3","limitsDelayed"],ie),Oe.variable(t("dateForLabelVal")).define("dateForLabelVal",["clickedSite","d3","limitsDelayed"],oe),Oe.variable(t("buoyClicked")).define("buoyClicked",["buoys","siteClicked"],le),Oe.variable(t()).define(["buoyDailyData"],se),Oe.variable(t("clickedSite")).define("clickedSite",["buoyDailyData","siteClicked"],ue),Oe.variable(t("colors")).define("colors",de),Oe.variable(t("buoys")).define("buoys",ce),Oe.variable(t("HWsForDate")).define("HWsForDate",["buoyDailyData","time1"],fe),Oe.variable(t("dayBeforeStart")).define("dayBeforeStart",["focus"],me),Oe.variable(t("buoyDailyData")).define("buoyDailyData",["dayBeforeStart","limitsDelayed"],be),Oe.variable(t("height")).define("height",he),Oe.variable(t("colorMHW")).define("colorMHW",["d3"],pe),Oe.variable(t("opacityMHW")).define("opacityMHW",["d3"],ve),Oe.variable(t("numFormat")).define("numFormat",["d3"],ge),Oe.variable(t("timeFormat")).define("timeFormat",["d3"],ye),Oe.variable(t("d3")).define("d3",["require"],we),Oe.define("initial p",["time1"],xe),Oe.variable(t("mutable p")).define("mutable p",["Mutable","initial p"],((e,t)=>new e(t))),Oe.variable(t("p")).define("p",["mutable p"],(e=>e.generator)),Oe.variable(t("hwEvent")).define("hwEvent",ke),Oe.variable(t("alldates")).define("alldates",["d3","dateExtent"],Se),Oe.variable(t("allmonths")).define("allmonths",["mhwBarData"],De),Oe.variable(t()).define(["monthlyTots"],Ce),Oe.variable(t("monthlyTots")).define("monthlyTots",["allmonths","cats","d3","mhwBarData"],Me),Oe.variable(t("monthlyGrouped")).define("monthlyGrouped",["groups","cats"],Ae),Oe.variable(t("cats")).define("cats",Te),Oe.variable(t("groups")).define("groups",["d3","monthlyTots"],Ee),Oe.variable(t("mhwBarData")).define("mhwBarData",["FileAttachment"],He),Oe.variable(t("tt")).define("tt",["FileAttachment"],We),Oe.variable(t()).define(["dataSsta"],Ne),Oe.variable(t()).define(["dataSstaOld"],_e),Oe.variable(t("dataSsta")).define("dataSsta",Fe),Oe.variable(t("dataSstaOld")).define("dataSstaOld",["FileAttachment"],Ie);const Be=e.module(n.default);return Oe.import("Scrubber",Be),Oe}},640:(e,t,a)=>{"use strict";function n(e){return e`# Stylized Scrubber


This reusable input is intended to drive animations while providing the reader interactive control on demand: the animation pauses when the user interacts with the slider, but can be resumed by clicking the play button. For examples, see [Bar Chart Race](/@mbostock/bar-chart-race-with-scrubber), [The Wealth & Health of Nations](/@mbostock/the-wealth-health-of-nations), [Solar Path](/@mbostock/solar-path), or [Animated Treemap](/@d3/animated-treemap).`}function r(e){return e`To use in your notebook:

~~~js
import {Scrubber} from "@mbostock/scrubber"
~~~
`}function i(e,t){return e(t)}function o(){return Array.from({length:2e4},((e,t)=>t))}function l(e,t){return e`The current value of *i* is ${t}.`}function s(e){return e`Given an array of *values* representing the discrete frames of the animation, such as an array of numbers or dates, Scrubber returns a [view-compatible input](/@observablehq/introduction-to-views). (It uses the [disposal promise](/@mbostock/disposal) to stop the animation automatically on invalidation.)`}function u(e){return e`## Options

Scrubber has several options which you can pass as the second argument.`}function d(e){return e`The *autoplay* option, which defaults to true, specifies whether the animation plays automatically. Set it to false to require the reader to click on the play button.`}function c(e,t){return e(t,{autoplay:!1})}function f(e){return e`The *loop* option, which defaults to true, specifies whether the animation should automatically restart from the beginning after the end is reached. Set it to false to require the reader to click the play button to restart the animation after it ends.`}function m(e,t){return e(t,{loop:!1})}function b(e){return e.update(3)}function h(e){return e`The *alternate* option, which defaults to false, specifies whether the animation should reverse direction when it reaches the end, rather than repeat from the start.`}function p(e,t){return e(t,{loop:!1,alternate:!0})}function v(e){return e`The *delay* option, which defaults to null, specifies how long to wait between frames in milliseconds. A null value means to use [requestAnimationFrame](https://developer.mozilla.org/en-US/docs/Web/API/window/requestAnimationFrame), which typically means sixty times per second (about 17ms). Non-null delays use [setInterval](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setInterval).`}function g(e){return e(["red","green","blue"],{delay:1e3})}function y(e){return e`The *loopDelay* option, which defaults to 0, specifies how long to wait before looping in milliseconds. This can be paired with the *initial* option to show the ending value before the animation starts anew from the beginning.`}function w(e,t){return e(t,{initial:t.length-1,loopDelay:1e3})}function x(e){return e`The *format* option, which defaults to the identity function, specifies how to display the currently-selected value. The *format* function is passed the current value, the current (zero-based) index, and the values array.`}function k(){return Array.from({length:365},((e,t)=>{const a=new Date(2019,0,1);return a.setDate(t+1),a}))}function S(e,t){return e(t,{autoplay:!1,loop:!1,format:e=>e.toLocaleString("en",{month:"long",day:"numeric"})})}function D(e){return e}function C(e){return e`If you have suggestions for other options you’d like to see, please let me know!`}function M(e){return e`---

## Implementation`}function A(e){return e`
<style>
  .button {
  border: 0;
  background: transparent;
  box-sizing: border-box;
  width: 100;
  height: 74px;
  border-color: transparent transparent transparent #202020;
  transition: 100ms all ease;
  cursor: pointer;
  border-style: solid;
  border-width: 37px 0 37px 60px;
accent-color:pink
}
.paused {
  border-style: double;
  border-width: 0px 0 0px 60px;
}
.button:hover {
  border-color: transparent transparent transparent #404040;
}
input{
 accent-color:white
}

  </style>
`}function T(e,t){return function(a,{format:n=(e=>e),initial:r=0,delay:i=null,autoplay:o=!0,loop:l=!0,loopDelay:s=null,alternate:u=!1}={}){a=Array.from(a);const d=e`<form style="font: 12px var(--sans-serif); font-variant-numeric: tabular-nums; display: flex; height: 50px; align-items: center;">
  <button name=b class=button  type=button ></button>
  <label style="display: flex; align-items: center;">
    <input name=i type=range min=0 max=${a.length-1} value=${r} step=1 style="width: 0px;">
    <output name=o style="margin-left: 0.4em;"></output>
  </label>
</form>`;let c=null,f=null,m=null,b=1;function h(){d.b.classList.add("paused"),null===i?c=requestAnimationFrame(g):m=setInterval(g,i)}function p(){d.b.classList.remove("paused"),null!==c&&(cancelAnimationFrame(c),c=null),null!==f&&(clearTimeout(f),f=null),null!==m&&(clearInterval(m),m=null)}function v(){return null!==c||null!==f||null!==m}function g(){if(d.i.valueAsNumber===(b>0?a.length-1:b<0?0:NaN)){if(!l)return p();if(u&&(b=-b),null!==s)return null!==c&&(cancelAnimationFrame(c),c=null),null!==m&&(clearInterval(m),m=null),void(f=setTimeout((()=>(y(),h())),s))}null===i&&(c=requestAnimationFrame(g)),y()}function y(){d.i.valueAsNumber=(d.i.valueAsNumber+b+a.length)%a.length,d.i.dispatchEvent(new CustomEvent("input",{bubbles:!0}))}return d.i.oninput=e=>{e&&e.isTrusted&&v()&&p(),d.value=a[d.i.valueAsNumber],d.o.value=n(d.value,d.i.valueAsNumber,a)},d.b.onclick=()=>{if(v())return p();b=u&&d.i.valueAsNumber===a.length-1?-1:1,d.i.valueAsNumber=(d.i.valueAsNumber+b)%a.length,d.i.dispatchEvent(new CustomEvent("input",{bubbles:!0})),h()},d.i.oninput(),o?h():p(),t.disposal(d).then(p),d}}function E(e,t){const a=e.module();return a.variable(t()).define(["md"],n),a.variable(t()).define(["md"],r),a.variable(t("viewof i")).define("viewof i",["Scrubber","numbers"],i),a.variable(t("i")).define("i",["Generators","viewof i"],((e,t)=>e.input(t))),a.variable(t("numbers")).define("numbers",o),a.variable(t()).define(["md","i"],l),a.variable(t()).define(["md"],s),a.variable(t()).define(["md"],u),a.variable(t("autoplay")).define("autoplay",["md"],d),a.variable(t()).define(["Scrubber","numbers"],c),a.variable(t("loop")).define("loop",["md"],f),a.variable(t("viewof Num")).define("viewof Num",["Scrubber","numbers"],m),a.variable(t("Num")).define("Num",["Generators","viewof Num"],((e,t)=>e.input(t))),a.variable(t()).define(["viewof Num"],b),a.variable(t()).define(["md"],h),a.variable(t()).define(["Scrubber","numbers"],p),a.variable(t("delay")).define("delay",["md"],v),a.variable(t()).define(["Scrubber"],g),a.variable(t("loopDelay")).define("loopDelay",["md"],y),a.variable(t()).define(["Scrubber","numbers"],w),a.variable(t("format")).define("format",["md"],x),a.variable(t("dates")).define("dates",k),a.variable(t("viewof date")).define("viewof date",["Scrubber","dates"],S),a.variable(t("date")).define("date",["Generators","viewof date"],((e,t)=>e.input(t))),a.variable(t()).define(["date"],D),a.variable(t()).define(["md"],C),a.variable(t()).define(["md"],M),a.variable(t("style")).define("style",["html"],A),a.variable(t("Scrubber")).define("Scrubber",["html","Inputs"],T),a}a.r(t),a.d(t,{default:()=>E})}}]);
//# sourceMappingURL=bundle.7386ce3214edd947dd96.js.map